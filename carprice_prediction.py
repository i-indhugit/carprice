# -*- coding: utf-8 -*-
"""carprice prediction

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1XsFfvpJALyWwpZgzTZXWLIm9VCRglhYn
"""

import numpy as np
import pandas as pd

from sklearn.linear_model import LinearRegression

from sklearn import metrics

from sklearn.model_selection import train_test_split

car_dataset=pd.read_csv('car data.csv')
car_dataset

pd.unique(car_dataset['Seller_Type'])

car_dataset.replace({'Fuel_Type':{'Petrol':0,'Diesel':1,'CNG':2}},inplace=True)
car_dataset.replace({'Transmission':{'Manual':0,'Automatic':1}},inplace=True)
car_dataset.replace({'Seller_Type':{'Dealer':0,'Individual':1}},inplace=True)

X=car_dataset.drop(['Car_Name','Selling_Price'],axis=1)
Y=car_dataset['Selling_Price']

print(X)

print(Y)

X_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size=0.1)

print(X.shape,X_train.shape,Y_test.shape)

model=LinearRegression()

model.fit(X_train,Y_train)

train_data_prediction=model.predict(X_train)

train_data_accuracy=metrics.r2_score(Y_train,train_data_prediction)
print(train_data_accuracy)

test_data_prediction=model.predict(X_test)

test_data_accuracy=metrics.r2_score(Y_test,test_data_prediction)
print(test_data_accuracy)

input_data=[2014,6.79,71000,1,0,0,1]
input_data_as_numpy_array=np.asarray(input_data)
input_data_reshape=input_data_as_numpy_array.reshape(1,-1)

prediction=model.predict(input_data_reshape)
print(prediction)